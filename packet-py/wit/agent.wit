package component:quest-v1;

interface engine-types {
    type quest-id = string;
    type task-id = string;

    enum status {
        locked,
        active,
        completed,
        failed
    }
}

interface host-quest-manager {
    use engine-types.{quest-id, task-id, status};

    // Register a simplified task (like a checkpoint)
    register-task: func(qid: quest-id, tid: task-id, description: string);

    // Update state of a task
    update-task: func(qid: quest-id, tid: task-id, s: status);
    
    // Notify player (Toast/Log)
    notify-player: func(message: string);
}

interface host-events {
    // Check if player is on a specific URL
    get-current-url: func() -> string;
}

interface host-console {
    log: func(msg: string);
}

interface host-content {
    // Register a content item (page, video, etc.) that the player should visit
    register-item: func(id: string, url: string, title: string, item-type: string);
}

world quest-agent {
    import host-console;
    import host-quest-manager;
    import host-events;
    import host-content;
    import engine-types;

    // Called on boot
    export init: func();

    // Called when the Player navigates
    export on-visit: func(url: string);
}